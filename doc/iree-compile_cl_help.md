<!--
 * @Author: Albresky albre02@outlook.com
 * @Date: 2025-07-12 20:40:54
 * @LastEditors: Albresky albre02@outlook.com
 * @LastEditTime: 2025-07-12 20:57:44
 * @FilePath: /iree-amd-aie/doc/iree-compile_cl_help.md
 * @Description: IREE-AMD-AIE é¡¹ç›® `iree-compile` å‘½ä»¤è¡Œå¸®åŠ©æ–‡æ¡£
-->
# `iree-compile` å¸®åŠ©æ–‡æ¡£

**æ¦‚è§ˆ**: IREE ç¼–è¯‘é©±åŠ¨ç¨‹åº

**ç”¨æ³•**: `iree-compile [é€‰é¡¹] <è¾“å…¥æ–‡ä»¶>`

>   - **`<è¾“å…¥æ–‡ä»¶>`**: æ‚¨çš„æ¨¡å‹æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ `.mlir` æ ¼å¼ã€‚å¦‚æœä½¿ç”¨ `-`ï¼Œè¡¨ç¤ºä»æ ‡å‡†è¾“å…¥æµè¯»å–ã€‚

-----

### <H2>ğŸš€ æ ¸å¿ƒç¼–è¯‘é€‰é¡¹</H2>

<p>è¿™äº›æ˜¯æ§åˆ¶ç¼–è¯‘æµç¨‹ã€è¾“å…¥å’Œè¾“å‡ºçš„æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€é‡è¦çš„é€‰é¡¹ã€‚</p>

  - **`--iree-hal-target-backends=<string>`**

      - **è§£é‡Š**: æŒ‡å®šè¦ä¸ºå“ªç§ç¡¬ä»¶åç«¯è¿›è¡Œç¼–è¯‘ã€‚ è¿™æ˜¯å†³å®šæœ€ç»ˆäº§ç‰©ç»™è°ç”¨çš„å…³é”®å‚æ•°ã€‚ä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªåç«¯ï¼Œç”¨é€—å·éš”å¼€ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # ä¸º AMD AIE ç¡¬ä»¶ç¼–è¯‘
        --iree-hal-target-backends=amd-aie

        # åŒæ—¶ä¸º CPU å’Œè‹±ä¼Ÿè¾¾ GPU ç¼–è¯‘
        --iree-hal-target-backends=llvm-cpu,cuda
        ```

  - **`-o <filename>`**

      - **è§£é‡Š**: æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åå­—ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        -o my_model.vmfb
        ```

  - **`--output-format=<value>`**

      - **è§£é‡Š**: æŒ‡å®šç¼–è¯‘äº§ç‰©çš„æ ¼å¼ã€‚
          - `vm-bytecode` (é»˜è®¤): ç¼–è¯‘æˆ IREE è™šæ‹Ÿæœºå¯ä»¥æ‰§è¡Œçš„äºŒè¿›åˆ¶å­—èŠ‚ç ã€‚ è¿™æ˜¯æœ€å¸¸ç”¨çš„æ ¼å¼ã€‚
          - `vm-c`: ç¼–è¯‘æˆ C è¯­è¨€æºä»£ç ã€‚
          - `vm-asm`: ç¼–è¯‘æˆ IREE è™šæ‹Ÿæœºçš„æ±‡ç¼–è¯­è¨€ï¼ˆä¸€ç§ç‰¹æ®Šçš„ MLIR æ ¼å¼ï¼‰ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # è¾“å‡º C æºç ï¼Œç”¨äºç ”ç©¶æˆ–é›†æˆåˆ° C é¡¹ç›®ä¸­
        --output-format=vm-c -o my_model.c
        ```

  - **`--compile-mode=<value>`**

      - **è§£é‡Š**: é€‰æ‹©ç¼–è¯‘æ¨¡å¼ï¼Œå†³å®šäº†æ•´ä¸ªç¼–è¯‘æµæ°´çº¿çš„ç±»å‹ã€‚
          - `std` (é»˜è®¤): æ ‡å‡†ç¼–è¯‘æµç¨‹ï¼Œé€‚ç”¨äºå°†å®Œæ•´æ¨¡å‹ç¼–è¯‘æˆå¯æ‰§è¡Œæ¨¡å—ã€‚
          - `hal-executable`: ç‰¹æ®Šæ¨¡å¼ï¼Œåªç¼–è¯‘ä¸€ä¸ªåŒ…å«ç¡¬ä»¶æŠ½è±¡å±‚ï¼ˆHALï¼‰å¯æ‰§è¡Œæ–‡ä»¶çš„æ¨¡å—ï¼Œå¸¸ç”¨äºåº•å±‚ç®—å­è°ƒè¯•ã€‚
          - `precompile`: é¢„ç¼–è¯‘æµæ°´çº¿ï¼Œè¿›è¡Œè¾“å…¥è½¬æ¢å’Œå…¨å±€ä¼˜åŒ–ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # å½“ä½ çš„è¾“å…¥ .mlir æ–‡ä»¶åªåŒ…å«ä¸€ä¸ª hal.executable æ—¶ä½¿ç”¨
        --compile-mode=hal-executable
        ```

  - **`--compile-to=<value>`**

      - **è§£é‡Š**: è®©ç¼–è¯‘æµç¨‹åœ¨æŸä¸ªç‰¹å®šé˜¶æ®µ**æå‰åœæ­¢**ï¼Œå¹¶è¾“å‡ºå½“æ—¶çš„ä¸­é—´ä»£ç ï¼ˆIRï¼‰ã€‚ è¿™æ˜¯è¿›è¡Œ**åˆ†æ­¥è°ƒè¯•**å’Œåˆ†æç¼–è¯‘è¿‡ç¨‹çš„åˆ©å™¨ã€‚
          - `input`: åœ¨è¾“å…¥å¤„ç†å’Œåˆæ­¥ lower ä¹‹ååœæ­¢ã€‚
          - `flow`: åœ¨ç¼–è¯‘åˆ° `flow` æ–¹è¨€ååœæ­¢ã€‚
          - `stream`: åœ¨ç¼–è¯‘åˆ° `stream` æ–¹è¨€ååœæ­¢ã€‚
          - `executable-targets`: åœ¨ä»£ç ç”Ÿæˆï¼ˆCodegenï¼‰å®Œæˆï¼Œç”Ÿæˆäº†ç‰¹å®šäºç¡¬ä»¶çš„ä»£ç ä¹‹ååœæ­¢ã€‚
          - `hal`: åœ¨ç¼–è¯‘åˆ° `hal` æ–¹è¨€ååœæ­¢ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # æŸ¥çœ‹ä»£ç ç”Ÿæˆåçš„ç»“æœï¼Œä½†ä¸è¿›è¡Œæœ€ç»ˆçš„æ‰“åŒ…
        --compile-to=executable-targets -o codegen_output.mlir
        ```

<br>
<details>
<summary><strong>â• ç‚¹å‡»å±•å¼€/æŠ˜å  æ›´å¤šç¼–è¯‘é˜¶æ®µé€‰é¡¹</strong></summary>

  - **`--compile-from=<value>`**
      - **è§£é‡Š**: è®©ç¼–è¯‘ä»æŸä¸ªç‰¹å®šé˜¶æ®µ**ä¹‹å**å¼€å§‹ï¼Œè·³è¿‡å‰é¢çš„æ­¥éª¤ã€‚ è¿™å¯¹äºä»å·²æœ‰çš„ä¸­é—´äº§ç‰©æ¢å¤ç¼–è¯‘å¾ˆæœ‰ç”¨ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº† stream.mlirï¼Œæƒ³ä» stream é˜¶æ®µä¹‹åç»§ç»­ç¼–è¯‘
        # iree-compile --compile-from=stream stream.mlir ...
        ```

</details>

-----

### <H2>ğŸ§  AMD AIE ä¸“ç”¨é€‰é¡¹</H2>

<p>è¿™äº›é€‰é¡¹ä¸“é—¨ç”¨äºæ§åˆ¶é’ˆå¯¹ AMD AIE ç¡¬ä»¶çš„ç¼–è¯‘è¡Œä¸ºã€‚</p>

  - **`--iree-amdaie-target-device=<value>`**

      - **è§£é‡Š**: **ï¼ˆæå…¶é‡è¦ï¼‰** æŒ‡å®šç›®æ ‡ AIE è®¾å¤‡çš„å…·ä½“å‹å·ã€‚ ä¸åŒçš„å‹å·æœ‰ä¸åŒçš„æ¶æ„ã€æ ¸å¿ƒæ•°å’Œå†…å­˜å¤§å°ï¼Œå¿…é¡»æ­£ç¡®é€‰æ‹©ã€‚
          - `npu1`: é»˜è®¤çš„ Phoenix NPU å‹å·ã€‚
          - `npu1_2col`: ä½¿ç”¨ 2 åˆ—æ ¸å¿ƒçš„ Phoenix NPUã€‚
          - `npu4`: Strix B0 NPUï¼Œæ‹¥æœ‰8åˆ—6è¡Œæ ¸å¿ƒã€‚
          - `xcvc1902`, `xcve2802` ç­‰: å…¶ä»–å…·ä½“çš„ Versal AI Core å™¨ä»¶å‹å·ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # æ˜ç¡®æŒ‡å®šç›®æ ‡è®¾å¤‡ä¸º npu1
        --iree-amdaie-target-device=npu1
        ```

  - **`--iree-amdaie-num-cols=<uint>`** å’Œ **`--iree-amdaie-num-rows=<uint>`**

      - **è§£é‡Š**: å‘ŠçŸ¥ç¼–è¯‘å™¨åœ¨ AIE æ ¸å¿ƒé˜µåˆ—ä¸­å¯ä»¥ä½¿ç”¨å¤šå°‘è¡Œå’Œå¤šå°‘åˆ—ã€‚ è¿™ä¼šå½±å“ç¼–è¯‘å™¨å¦‚ä½•åˆ‡åˆ†ï¼ˆTilingï¼‰è®¡ç®—ä»»åŠ¡ä»¥é€‚åº”ç¡¬ä»¶è§„æ¨¡ã€‚ æ³¨æ„ï¼Œå¯¹äºæŸäº›ç®—å­ï¼ˆå¦‚å·ç§¯ï¼‰ï¼Œæ­¤æ ‡å¿—å¯èƒ½è¢«å¿½ç•¥ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # é™åˆ¶ç¼–è¯‘å™¨æœ€å¤šä½¿ç”¨ 4 åˆ—æ ¸å¿ƒå’Œ 2 è¡Œæ ¸å¿ƒ
        --iree-amdaie-num-cols=4 --iree-amdaie-num-rows=2
        ```

  - **`--iree-amdaie-enable-ukernels=<string>`**

      - **è§£é‡Š**: å¯ç”¨é’ˆå¯¹ç‰¹å®šç®—å­çš„é«˜åº¦ä¼˜åŒ–çš„å¾®å†…æ ¸ï¼ˆuKernelï¼‰ï¼Œä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚
          - `none`: ä¸å¯ç”¨ä»»ä½•å¾®å†…æ ¸ã€‚
          - `all`: å¯ç”¨æ‰€æœ‰å¯ç”¨çš„å¾®å†…æ ¸ã€‚
          - `matmul,conv`: åªå¯ç”¨ `matmul` å’Œ `conv` ç®—å­çš„å¾®å†…æ ¸ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼Œå¯ç”¨æ‰€æœ‰å¾®å†…æ ¸
        --iree-amdaie-enable-ukernels=all
        ```

  - **`--iree-amdaie-lower-to-aie-pipeline=<value>`**

      - **è§£é‡Š**: é€‰æ‹©å°†é«˜å±‚ç®—å­ï¼ˆå¦‚ Linalgï¼‰é™ä½åˆ° AIE æŒ‡ä»¤æ‰€ä½¿ç”¨çš„æµæ°´çº¿ç­–ç•¥ã€‚
          - `air`: é€šè¿‡ AIR (AI Engine IR) è¿›è¡Œé™ä½ã€‚
          - `objectFifo`: ä½¿ç”¨ objectFifo æœºåˆ¶è¿›è¡Œé™ä½ï¼Œè¿™æ˜¯ä¸€ç§æ•°æ®äº¤æ¢æ–¹å¼ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # é€‰æ‹© objectFifo é™ä½æµæ°´çº¿
        --iree-amdaie-lower-to-aie-pipeline=objectFifo
        ```

  - **`--iree-amdaie-show-invoked-commands`**

      - **è§£é‡Š**: åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¼šè°ƒç”¨å¾ˆå¤šå¤–éƒ¨å·¥å…·ï¼ˆå¦‚ aie-opt, peano-opt, vitis aietools ç­‰ï¼‰ã€‚ ä½¿ç”¨æ­¤é€‰é¡¹å¯ä»¥**æ‰“å°å‡ºæ‰€æœ‰è¿™äº›è¢«è°ƒç”¨çš„å‘½ä»¤**åŠå…¶å‚æ•°ï¼Œå¯¹äºè°ƒè¯•å·¥å…·é“¾æœ¬èº«éå¸¸æœ‰å¸®åŠ©ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # æŸ¥çœ‹ç¼–è¯‘è¿‡ç¨‹ä¸­éƒ½è°ƒç”¨äº†å“ªäº›åº•å±‚å‘½ä»¤
        --iree-amdaie-show-invoked-commands
        ```

  - **`--iree-amd-aie-peano-install-dir=<string>`** å’Œ **`--iree-amd-aie-vitis-install-dir=<string>`**

      - **è§£é‡Š**: åˆ†åˆ«æŒ‡å®š Peano ç¼–è¯‘å™¨ï¼ˆä¸€ä¸ªæ–°çš„ AIE åç«¯ï¼‰å’Œ Vitis aietools çš„å®‰è£…è·¯å¾„ã€‚é€šå¸¸ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¯»æ‰¾ï¼Œä½†åœ¨ç‰¹æ®Šç¯å¢ƒä¸‹éœ€è¦æ‰‹åŠ¨æŒ‡å®šã€‚
      - **ç¤ºä¾‹**:
        ```bash
        --iree-amd-aie-peano-install-dir=/opt/peano
        --iree-amd-aie-vitis-install-dir=/opt/Xilinx/Vitis/2023.2
        ```

  - **`--iree-amdaie-enable-control-packet`**

      - **è§£é‡Š**: å¯ç”¨æ§åˆ¶åŒ…ï¼ˆControl Packetï¼‰åŠŸèƒ½ã€‚ è¿™æ˜¯ä¸€ç§ç”¨äºå¿«é€Ÿé‡æ–°é…ç½® AIE ç¡¬ä»¶çš„æŠ€æœ¯ï¼Œå¯ä»¥å°†é…ç½®ä¿¡æ¯æ‰“åŒ…å‘é€ï¼Œè€Œä¸æ˜¯å®Œå…¨é‡æ–°åŠ è½½ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # ä¸ºéœ€è¦åŠ¨æ€é…ç½®çš„åœºæ™¯å¯ç”¨æ§åˆ¶åŒ…
        --iree-amdaie-enable-control-packet
        ```

<br>
<details>
<summary><strong>â• ç‚¹å‡»å±•å¼€/æŠ˜å  æ›´å¤š AMD AIE é€‰é¡¹</strong></summary>

  - **`--iree-amdaie-device-hal=<value>`**: è®¾ç½®ç›®æ ‡è®¾å¤‡çš„ç¡¬ä»¶æŠ½è±¡å±‚ï¼ˆHALï¼‰ã€‚ å¯ä»¥æ˜¯ `xrt` æˆ– `xrt-lite`ã€‚
  - **`--iree-amdaie-tile-pipeline=<value>`**: é€‰æ‹©ç”¨äº tiling çš„æµæ°´çº¿ç­–ç•¥ã€‚ ä¾‹å¦‚ `pack-peel` æˆ– `conv-decompose`ã€‚
  - **`--iree-amdaie-packet-flow-strategy=<value>`**: å¯ç”¨åŒ…è·¯ç”±æ•°æ®ç§»åŠ¨ã€‚ `auto` é€‰é¡¹ä¼šè¿›è¡Œæ‹¥å¡æ„ŸçŸ¥åˆ†é…ã€‚
  - **`--iree-amdaie-enable-function-outlining=<value>`**: æ§åˆ¶æ˜¯å¦å°† linalg æ“ä½œæå–æˆç‹¬ç«‹å‡½æ•°ã€‚
  - **`--iree-amdaie-call-replication=<int>`**: é‡å¤è°ƒç”¨è¢«æå–å‡ºçš„å‡½æ•°ã€‚ ä¸»è¦ç”¨äºæ€§èƒ½å‰–æï¼Œä¾‹å¦‚n=0æµ‹è¯•æ•°æ®ç§»åŠ¨ï¼Œn\>\>1æµ‹è¯•æ ¸å¿ƒè®¡ç®—ã€‚
  - **`--iree-amdaie-stack-size=<uint>`**: è®¾ç½®AIEæ ¸å¿ƒçš„å †æ ˆå¤§å°ã€‚
  - **`--iree-amd-aie-additional-peano-opt-flags=<string>`**: ä¸º Peano çš„ `opt` å·¥å…·æä¾›é¢å¤–çš„æ ‡å¿—ï¼Œä¾‹å¦‚ `"-O3 --magic-flag"`ã€‚
  - **`--iree-amd-aie-install-dir=<string>`**: AMDAIE çš„å®‰è£…ç›®å½•è·¯å¾„ã€‚
  - **`--iree-amdaie-enable-infinite-loop-around-core-block`**: åœ¨æ ¸å¿ƒä»£ç å—å¤–æ’å…¥æ— é™å¾ªç¯ï¼Œé€šå¸¸ä»…ç”¨äºç²¾ç¡®çš„æ€§èƒ½æµ‹é‡ã€‚
  - **`--iree-amdaie-enable-vectorization-passes`**: å¯ç”¨æˆ–ç¦ç”¨æŸäº›æµæ°´çº¿ä¸­çš„å‘é‡åŒ– passï¼Œä»…ç”¨äºå¼€å‘ã€‚
  - **`--iree-amdaie-enable-coalescing-loops`**: åœ¨å‘é‡åŒ–æ—¶å¯ç”¨å¾ªç¯åˆå¹¶ï¼Œä»…ç”¨äºå¼€å‘ã€‚
  - **`--iree-amdaie-enable-collapsing-unit-dims`**: åœ¨å‘é‡åŒ–æ—¶å¯ç”¨å¯¹å•ä½ç»´åº¦çš„æŠ˜å ï¼Œä»…ç”¨äºå¼€å‘ã€‚
  - **`--iree-amdaie-matmul-elementwise-fusion`**: å¯ç”¨ MLIR-AIR ä¸­ç”¨äº matmul-elementwise èåˆçš„ç‰¹æ®Š passï¼Œä»…ç”¨äºå¼€å‘ã€‚

</details>

-----

### <H2>âš™ï¸ å…¨å±€ä¼˜åŒ–ä¸æµç¨‹æ§åˆ¶</H2>

  - **`--iree-opt-level=<optimization level>`**

      - **è§£é‡Š**: è®¾ç½®å…¨å±€ä¼˜åŒ–ç­‰çº§ï¼Œåº”ç”¨äºæ•´ä¸ªç¼–è¯‘æµç¨‹ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # ä¸ºäº†è·å¾—å‘å¸ƒçº§çš„æ€§èƒ½ï¼Œä½¿ç”¨O3ä¼˜åŒ–
        --iree-opt-level=3
        ```

  - **`--iree-opt-data-tiling`**

      - **è§£é‡Š**: å¯ç”¨æ•°æ®åˆ‡åˆ†ï¼ˆData Tilingï¼‰ä¼˜åŒ–ã€‚ è¿™æ˜¯ä¸€ä¸ªå…³é”®çš„æ€§èƒ½ä¼˜åŒ–æ­¥éª¤ï¼Œå®ƒä¼šå°†å¤§å—æ•°æ®åˆ‡æˆå°å—ä»¥æ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜ã€‚ é»˜è®¤å¼€å¯ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # å¦‚æœæƒ³ç¦ç”¨æ•°æ®åˆ‡åˆ†ä»¥è¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥è®¾ç½®ä¸º false
        --iree-opt-data-tiling=false
        ```

  - **`--iree-input-type=<string>`**

      - **è§£é‡Š**: æŒ‡å®šè¾“å…¥æ¨¡å‹çš„æ–¹è¨€ç±»å‹ï¼Œä¾‹å¦‚ `tosa`, `stablehlo`ã€‚ `auto` ä¼šè®©ç¼–è¯‘å™¨è‡ªåŠ¨æ£€æµ‹ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # æ˜ç¡®å‘ŠçŸ¥è¾“å…¥æ˜¯ tosa æ–¹è¨€
        --iree-input-type=tosa
        ```

<br>
<details>
<summary><strong>â• ç‚¹å‡»å±•å¼€/æŠ˜å  æ›´å¤šå…¨å±€ä¼˜åŒ–é€‰é¡¹</strong></summary>

  - **`--iree-global-optimization-opt-level=<optimization level>`**: å•ç‹¬ä¸ºå…¨å±€ä¼˜åŒ–é˜¶æ®µè®¾ç½®ä¼˜åŒ–ç­‰çº§ã€‚
  - **`--iree-dispatch-creation-opt-level=<optimization level>`**: å•ç‹¬ä¸º dispatch region åˆ›å»ºé˜¶æ®µè®¾ç½®ä¼˜åŒ–ç­‰çº§ã€‚
  - **`--iree-opt-const-eval`**: å¯ç”¨å¸¸é‡çš„å³æ—¶æ±‚å€¼ï¼ˆé»˜è®¤å¼€å¯ï¼‰ã€‚
  - **`--iree-opt-const-expr-hoisting`**: å°†å¸¸é‡è¡¨è¾¾å¼çš„ç»“æœæå‡ä¸ºä¸å¯å˜çš„å…¨å±€åˆå§‹åŒ–å™¨ã€‚
  - **`--iree-opt-numeric-precision-reduction`**: åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œå°†æ•°å€¼ç²¾åº¦é™ä½åˆ°æ›´ä½çš„ä½å®½ã€‚
  - **`--iree-input-demote-f32-to-f16`**: åœ¨å…¨å±€ä¼˜åŒ–å‰ï¼Œå¼ºåˆ¶å°†æ‰€æœ‰ f32 æ“ä½œå’Œå€¼è½¬æ¢ä¸º f16ã€‚
  - **`--iree-scheduling-optimize-bindings`**: å¯ç”¨ç»‘å®šèåˆå’Œè°ƒåº¦ç‚¹ç‰¹åŒ–ã€‚
  - **`--iree-flow-enable-pad-handling`**: å¯ç”¨å¯¹ `tensor.pad` æ“ä½œçš„åŸç”Ÿå¤„ç†ã€‚

</details>

-----

### <H2>ğŸ MLIR è°ƒè¯•ä¸æ‰“å°é€‰é¡¹\</H2>

<p>è¿™äº›é€‰é¡¹ç”¨äºåœ¨ç¼–è¯‘çš„å„ä¸ªé˜¶æ®µæ‰“å°ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰ï¼Œæ˜¯è°ƒè¯•ç¼–è¯‘é—®é¢˜çš„æ ¸å¿ƒå·¥å…·ã€‚</p>

  - **`--mlir-print-ir-before-all`** å’Œ **`--mlir-print-ir-after-all`**

      - **è§£é‡Š**: åˆ†åˆ«åœ¨**æ¯ä¸ª** MLIR Pass (ç¼–è¯‘æ­¥éª¤) **æ‰§è¡Œå‰** æˆ–**æ‰§è¡Œå** æ‰“å°å‡ºæ•´ä¸ªæ¨¡å—çš„ IRã€‚è¿™ä¼šäº§ç”Ÿå¤§é‡è¾“å‡ºï¼Œä½†èƒ½è®©ä½ ç²¾ç¡®åœ°çœ‹åˆ°æ¯ä¸€æ­¥å¯¹ä»£ç åšäº†ä»€ä¹ˆæ”¹å˜ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # è¿½è¸ªæ‰€æœ‰ Pass çš„æ•ˆæœ
        --mlir-print-ir-after-all
        ```

  - **`--mlir-print-ir-before=<pass-arg>`** å’Œ **`--mlir-print-ir-after=<pass-arg>`**

      - **è§£é‡Š**: åªåœ¨**æŒ‡å®š**çš„æŸä¸ª Pass **æ‰§è¡Œå‰** æˆ–**æ‰§è¡Œå** æ‰“å° IRã€‚è¿™æ¯” `...-all` çš„ç›®æ ‡æ›´æ˜ç¡®ã€‚`<pass-arg>` æ˜¯ Pass çš„å‚æ•°åã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # åªçœ‹ iree-amdaie-tile-and-fuse è¿™ä¸ª Pass æ‰§è¡Œåçš„ç»“æœ
        --mlir-print-ir-after=iree-amdaie-tile-and-fuse
        ```

  - **`--mlir-pass-statistics`**

      - **è§£é‡Š**: æ˜¾ç¤ºæ¯ä¸ª Pass çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä¾‹å¦‚å®ƒæ”¹å˜äº†å¤šå°‘ä¸ªæ“ä½œï¼ˆOpï¼‰ã€‚
      - **ç¤ºä¾‹**:
        ```bash
        --mlir-pass-statistics
        ```

  - **`--mlir-timing`**

      - **è§£é‡Š**: æ˜¾ç¤ºæ¯ä¸ª Pass çš„æ‰§è¡Œè€—æ—¶ï¼Œç”¨äºæ€§èƒ½åˆ†æã€‚
      - **ç¤ºä¾‹**:
        ```bash
        --mlir-timing
        ```

  - **`--dump-compilation-phases-to=<string>`**

      - **è§£é‡Š**: å°†æ¯ä¸ªä¸»è¦ç¼–è¯‘é˜¶æ®µï¼ˆå¦‚ `flow`, `stream`, `hal`ï¼‰ç»“æŸæ—¶çš„ IR è½¬å‚¨åˆ°ä¸€ä¸ªæŒ‡å®šçš„ç›®å½•ä¸­ï¼Œæ¯ä¸ªé˜¶æ®µä¸€ä¸ªæ–‡ä»¶ã€‚ è¿™æ¯”æ‰“å°åˆ°æ§åˆ¶å°æ›´æ–¹ä¾¿ç®¡ç†å’Œæ¯”è¾ƒã€‚
      - **ç¤ºä¾‹**:
        ```bash
        # å°†æ‰€æœ‰ä¸­é—´ç»“æœä¿å­˜åˆ° /tmp/iree_dumps/ ç›®å½•
        --dump-compilation-phases-to=/tmp/iree_dumps/
        ```

<br>
<details>
<summary><strong>â• ç‚¹å‡»å±•å¼€/æŠ˜å  æ›´å¤šè°ƒè¯•æ‰“å°é€‰é¡¹</strong></summary>

  - **`--mlir-print-ir-module-scope`**: æ‰“å° IR æ—¶ï¼Œæ€»æ˜¯ä»é¡¶å±‚çš„æ¨¡å—å¼€å§‹æ‰“å°ã€‚
  - **`--mlir-print-op-on-diagnostic`**: å½“æŠ¥å‘Šè¯Šæ–­ä¿¡æ¯ï¼ˆå¦‚é”™è¯¯æˆ–è­¦å‘Šï¼‰æ—¶ï¼ŒåŒæ—¶æ‰“å°å‡ºç›¸å…³çš„æ“ä½œã€‚
  - **`--mlir-print-stacktrace-on-diagnostic`**: å½“æŠ¥å‘Šè¯Šæ–­ä¿¡æ¯æ—¶ï¼ŒåŒæ—¶æ‰“å°å‡ºå½“å‰çš„è°ƒç”¨æ ˆã€‚
  - **`--mlir-pretty-debuginfo`**: ä»¥æ›´ç¾è§‚ã€æ˜“è¯»çš„æ ¼å¼æ‰“å°è°ƒè¯•ä¿¡æ¯ã€‚
  - **`--verify`**: åœ¨æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹ä¸­éªŒè¯ IR çš„æ­£ç¡®æ€§ã€‚

</details>

-----

### <H2>ğŸŒ å…¶ä»–é€šç”¨å’Œä¸“ä¸šé€‰é¡¹ï¼ˆæŠ˜å ï¼‰</H2>

<details>
<summary><strong> HAL (ç¡¬ä»¶æŠ½è±¡å±‚) é€‰é¡¹</strong></summary>

  - **`--iree-hal-dump-executable-files-to=<string>`**: ä¸€ä¸ªå…ƒæ ‡å¿—ï¼Œç”¨äºå°†æ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶ç›¸å…³çš„å†…å®¹ï¼ˆæºç ã€äºŒè¿›åˆ¶ã€ä¸­é—´æ–‡ä»¶ç­‰ï¼‰å†™å…¥æŒ‡å®šè·¯å¾„ã€‚
  - **`--iree-hal-dump-executable-binaries-to=<string>`**: å°†ç¿»è¯‘å’Œåºåˆ—åŒ–åçš„å¯æ‰§è¡Œæ–‡ä»¶äºŒè¿›åˆ¶å†…å®¹å†™å…¥æŒ‡å®šè·¯å¾„ã€‚
  - **`--iree-hal-dump-executable-intermediates-to=<string>`**: å°†ç¿»è¯‘è¿‡ç¨‹ä¸­çš„ä¸­é—´æ–‡ä»¶ï¼ˆå¦‚ .bc, .oï¼‰å†™å…¥æŒ‡å®šè·¯å¾„ã€‚
  - **`--iree-hal-dump-executable-sources-to=<string>`**: å°†æ¯ä¸ª `hal.executable` çš„è¾“å…¥æºç åˆ—è¡¨å†™å…¥æŒ‡å®šè·¯å¾„ã€‚
  - **`--iree-hal-executable-debug-level=<int>`**: å¯æ‰§è¡Œæ–‡ä»¶ç¿»è¯‘çš„è°ƒè¯•ç­‰çº§ï¼ˆ0-3ï¼‰ã€‚
  - **`--iree-hal-list-target-backends`**: åˆ—å‡ºæ‰€æœ‰å·²æ³¨å†Œçš„ã€å¯ç”¨äºå¯æ‰§è¡Œæ–‡ä»¶ç¼–è¯‘çš„ç›®æ ‡åç«¯ã€‚

</details>

<details>
<summary><strong> LLVMCPU Target (CPUåç«¯) é€‰é¡¹</strong></summary>

  - **`--iree-llvmcpu-target-triple=<string>`**: æŒ‡å®š LLVM çš„ç›®æ ‡ä¸‰å…ƒç»„ï¼ˆTarget Tripleï¼‰ï¼Œä¾‹å¦‚ `x86_64-linux-gnu`ã€‚
  - **`--iree-llvmcpu-target-cpu=<string>`**: æŒ‡å®š LLVM çš„ç›®æ ‡ CPU å‹å·ã€‚ ä½¿ç”¨ `host` æ¥è‡ªåŠ¨æ£€æµ‹æœ¬æœºCPUã€‚
  - **`--iree-llvmcpu-target-cpu-features=<string>`**: æŒ‡å®š LLVM çš„ç›®æ ‡ CPU ç‰¹æ€§ï¼Œä¾‹å¦‚ `+avx2`ã€‚ ä½¿ç”¨ `host` æ¥è‡ªåŠ¨æ£€æµ‹ã€‚
  - **`--iree-llvmcpu-debug-symbols`**: ç”Ÿæˆå¹¶åµŒå…¥è°ƒè¯•ä¿¡æ¯ï¼ˆå¦‚ DWARFï¼‰ã€‚
  - **`--iree-llvmcpu-link-static`**: é™æ€é“¾æ¥ç³»ç»Ÿåº“ï¼Œä»¥å‡å°‘è¿è¡Œæ—¶ä¾èµ–ã€‚
  - **`--iree-llvmcpu-enable-ukernels=<string>`**: ä¸º LLVMCPU åç«¯å¯ç”¨å¾®å†…æ ¸ã€‚
  - **`--iree-llvmcpu-loop-vectorization`**: å¯ç”¨ LLVM çš„å¾ªç¯å‘é‡åŒ–ä¼˜åŒ–ã€‚
  - **`--iree-llvmcpu-sanitize=<value>`**: åº”ç”¨ LLVM çš„æ¶ˆæ¯’å™¨ï¼ˆSanitizerï¼‰ç‰¹æ€§ï¼Œå¦‚åœ°å€æ¶ˆæ¯’å™¨ (`address`) æˆ–çº¿ç¨‹æ¶ˆæ¯’å™¨ (`thread`)ã€‚

</details>

<details>
<summary><strong> Plugin (æ’ä»¶) å’Œ Preprocessing (é¢„å¤„ç†) é€‰é¡¹</strong></summary>

  - **`--iree-plugin=<string>`**: æ¿€æ´»æŒ‡å®šçš„æ’ä»¶ã€‚
  - **`--iree-list-plugins`**: åˆ—å‡ºæ‰€æœ‰å·²åŠ è½½çš„æ’ä»¶ã€‚
  - **`--iree-preprocessing-pass-pipeline=<string>`**: åœ¨æ­£å¸¸çš„ IREE ç¼–è¯‘æµç¨‹å¼€å§‹å‰ï¼Œå…ˆè¿è¡Œä¸€ä¸ªè‡ªå®šä¹‰çš„ pass æµæ°´çº¿ã€‚
  - **`--iree-preprocessing-pdl-spec-filename=<string>`**: ä½¿ç”¨æŒ‡å®šçš„ PDL æè¿°æ–‡ä»¶è¿›è¡Œé¢„å¤„ç†ã€‚

</details>

<details>
<summary><strong> VM (è™šæ‹Ÿæœº) é€‰é¡¹</strong></summary>

  - **`--iree-vm-bytecode-module-optimize`**: åœ¨åºåˆ—åŒ–ä¹‹å‰ï¼Œå¯¹ VM æ¨¡å—è¿›è¡Œä¼˜åŒ–ï¼ˆå¦‚ CSEã€å†…è”ï¼‰ã€‚
  - **`--iree-vm-target-index-bits=<int>`**: è®¾ç½®ç´¢å¼•ç±»å‹çš„ä½å®½ã€‚
  - **`--iree-vm-target-truncate-unsupported-floats`**: å½“ä¸æ”¯æŒ f64 æ—¶ï¼Œå°†å…¶æˆªæ–­ä¸º f32ã€‚

</details>